(function(a,n){typeof exports=="object"&&typeof module<"u"?n(exports):typeof define=="function"&&define.amd?define(["exports"],n):(a=typeof globalThis<"u"?globalThis:a||self,n(a.Bartender={}))})(this,function(a){"use strict";class n extends Error{constructor(e){super(e),this.name="Bartender error"}}class u extends CustomEvent{constructor(e,t){super(e,t)}}class o extends CustomEvent{constructor(e,t){super(e,t)}}class d extends CustomEvent{constructor(e,t){super(e,t)}}class c extends CustomEvent{constructor(e,t){super(e,t)}}const p=s=>Object.entries(s).reduce((e,[t,r])=>(typeof r>"u"||(e[t]=r),e),{}),f=(s,e=document)=>s instanceof Element?s:typeof s=="string"?e.querySelector(s):null,b=(s=100)=>new Promise(e=>s?setTimeout(e,s):e());class l{debug=!1;initialized=!1;_name="";el;_position="left";_modal=!0;_overlay=!0;_permanent=!1;_scrollTop=!0;isOpened=!1;onCloseHandler;onClickHandler;constructor(e,t={}){if(!e)throw new n("Bar name is required");this.name=e;const r=f(t.el||null);if(!r)throw new n(`Element for bar '${this.name}' is required`);if(r.tagName!=="DIALOG")throw new n(`Bar element for '${this.name}' must be a <dialog> element`);this.el=r,this.el.classList.add("bartender-bar","bartender-bar--closed"),this.position=t.position??this._position,this.modal=t.modal??this._modal,this.overlay=t.overlay??this._overlay,this.permanent=t.permanent??this._permanent,this.scrollTop=t.scrollTop??this._scrollTop,this.onCloseHandler=async i=>{this.debug&&console.debug("Closing bar",this),this.el.dispatchEvent(new o("bartender-bar-before-close",{bubbles:!0,detail:{bar:this}})),this.el.classList.remove("bartender-bar--open"),this.isOpened=!1,await b(this.getTransitionDuration()),this.el.classList.add("bartender-bar--closed"),this.el.dispatchEvent(new o("bartender-bar-after-close",{bubbles:!0,detail:{bar:this}})),this.debug&&console.debug("Finished closing bar",this)},this.onClickHandler=i=>{const h=this.el.getBoundingClientRect();this.permanent===!1&&(h.left>i.clientX||h.right<i.clientX||h.top>i.clientY||h.bottom<i.clientY)&&(i.stopPropagation(),this.el.dispatchEvent(new o("bartender-bar-backdrop-click",{bubbles:!0,detail:{bar:this}})))},this.el.addEventListener("close",this.onCloseHandler),this.el.addEventListener("click",this.onClickHandler),this.initialized=!0}destroy(){return this.el.classList.remove("bartender-bar",`bartender-bar--position-${this.position}`),this.el.removeEventListener("close",this.onCloseHandler),this.el.removeEventListener("click",this.onClickHandler),this}get name(){return this._name}set name(e){this._name=e,this.initialized!==!1&&(this.el.dispatchEvent(new d("bartender-bar-updated",{bubbles:!0,detail:{bar:this,property:"name",value:e}})),this.debug&&console.debug("Updated bar name",this))}get position(){return this._position}set position(e){if(!e)throw new n(`Position is required for bar '${this.name}'`);const t=["left","right","top","bottom","center"];if(!t.includes(e))throw new n(`Invalid position '${e}' for bar '${this.name}'. Use one of the following: ${t.join(", ")}.`);this.el.classList.remove(`bartender-bar--position-${this._position}`),this.el.classList.add(`bartender-bar--position-${e}`),this._position=e,this.initialized!==!1&&(this.el.dispatchEvent(new d("bartender-bar-updated",{bubbles:!0,detail:{bar:this,property:"position",value:e}})),this.debug&&console.debug("Updated bar position",this))}get modal(){return this._modal}set modal(e){const t=this._modal===!0?"modal":"standard",r=e===!0?"modal":"standard";this.el.classList.remove(`bartender-bar--mode-${t}`),this.el.classList.add(`bartender-bar--mode-${r}`),this._modal=e,this.initialized!==!1&&(this.el.dispatchEvent(new d("bartender-bar-updated",{bubbles:!0,detail:{bar:this,property:"modal",value:e}})),this.debug&&console.debug("Updated bar modal setting",this))}get overlay(){return this._overlay}set overlay(e){this._overlay=e,e===!0?this.el.classList.add("bartender-bar--has-overlay"):this.el.classList.remove("bartender-bar--has-overlay"),this.initialized!==!1&&(this.el.dispatchEvent(new d("bartender-bar-updated",{bubbles:!0,detail:{bar:this,property:"overlay",value:e}})),this.debug&&console.debug("Updated bar overlay",this))}get permanent(){return this._permanent}set permanent(e){this._permanent=e,this.initialized!==!1&&(this.el.dispatchEvent(new d("bartender-bar-updated",{bubbles:!0,detail:{bar:this,property:"permanent",value:e}})),this.debug&&console.debug("Updated bar permanence",this))}get scrollTop(){return this._scrollTop}set scrollTop(e){this._scrollTop=e,this.initialized!==!1&&(this.el.dispatchEvent(new d("bartender-bar-updated",{bubbles:!0,detail:{bar:this,property:"scrollTop",value:e}})),this.debug&&console.debug("Updated bar scrollTop",this))}isOpen(){return this.isOpened}async open(){return this.el.dispatchEvent(new o("bartender-bar-before-open",{bubbles:!0,detail:{bar:this}})),this.debug&&console.debug("Opening bar",this),this.modal===!0?this.el.showModal():this.el.show(),this.scrollTop===!0&&this.scrollToTop(),this.el.classList.remove("bartender-bar--closed"),this.el.classList.add("bartender-bar--open"),this.isOpened=!0,await b(this.getTransitionDuration()),this.debug&&console.debug("Finished opening bar",this),this.el.dispatchEvent(new o("bartender-bar-after-open",{bubbles:!0,detail:{bar:this}})),this}async close(){return this.el.close(),await b(this.getTransitionDuration()),this}scrollToTop(){return this.el.scrollTo(0,0),this}getTransitionDuration(){return parseFloat(window.getComputedStyle(this.el).transitionDuration||"0")*1e3}}class m{_debug=!1;bars=[];openBars=[];barDefaultOptions={el:null,position:"left",overlay:!0,permanent:!1,scrollTop:!0};onKeydownHandler;onBarBeforeOpenHandler;onBarBeforeCloseHandler;onBarBackdropClickHandler;constructor(e={},t={}){this.debug=e.debug??this._debug,this.barDefaultOptions={...this.barDefaultOptions,...p(t)},this.onKeydownHandler=(r=>{if(r.key==="Escape"&&this.getOpenBar(!0)?.permanent===!0){r.preventDefault();return}}).bind(this),this.onBarBeforeOpenHandler=r=>{this.openBars.push(r.detail.bar),this.openBars.some(i=>i.modal===!0)&&document.body.classList.add("bartender-disable-scroll"),document.body.classList.add("bartender-open")},this.onBarBeforeCloseHandler=r=>{this.openBars.splice(this.openBars.indexOf(r.detail.bar),1),this.openBars.length||document.body.classList.remove("bartender-open"),this.openBars.some(i=>i.modal===!0)||document.body.classList.remove("bartender-disable-scroll")},this.onBarBackdropClickHandler=r=>{this.getOpenBar(!0)?.name===r.detail.bar.name&&this.close(r.detail.bar.name)},typeof document<"u"&&typeof window<"u"&&(document.addEventListener("keydown",this.onKeydownHandler),document.addEventListener("bartender-bar-before-open",this.onBarBeforeOpenHandler),document.addEventListener("bartender-bar-before-close",this.onBarBeforeCloseHandler),document.addEventListener("bartender-bar-backdrop-click",this.onBarBackdropClickHandler),document.body.classList.add("bartender-ready"),window.dispatchEvent(new u("bartender-init",{detail:{bartender:this}})),this.debug&&console.debug("Bartender initialized",this))}get debug(){return this._debug}set debug(e){this._debug=e;for(const t of this.bars)t.debug=e}getBar(e){return this.bars.find(t=>t.name===e)||null}getOpenBar(e=void 0){const t=typeof e=="boolean"?this.openBars.filter(r=>r.modal===e):this.openBars;return t.length?t[t.length-1]:null}addBar(e,t={}){if(!e)throw new n("Bar name is required");if(this.getBar(e))throw new n(`Bar with name '${e}' is already defined`);const r=new l(e,{...this.barDefaultOptions,...p(t)});if(r.debug=this.debug,this.bars.some(i=>i.el===r.el))throw new n(`Element of bar '${r.name}' is already being used for another bar`);return this.bars.push(r),window.dispatchEvent(new o("bartender-bar-added",{detail:{bar:r}})),this.debug&&console.debug("Added a new bar",r),r}removeBar(e){if(!e)throw new n("Bar name is required");const t=this.getBar(e);if(!t)throw new n(`Bar with name '${e}' was not found`);return t.isOpen()===!0&&this.close(e),t.destroy(),this.bars.splice(this.bars.findIndex(r=>r.name===e),1),window.dispatchEvent(new c("bartender-bar-removed",{detail:{name:e}})),this.debug&&console.debug(`Removed bar '${e}'`),this}async open(e,t=!1){const r=e instanceof l?e:typeof e=="string"?this.getBar(e):null;if(!r)throw new n(`Unknown bar '${e}'`);return r.isOpen()===!0||(t===!1&&this.closeAll(),await r.open()),r}async close(e){const t=e?e instanceof l?e:typeof e=="string"?this.getBar(e):null:this.getOpenBar();return!t||!t.isOpen()?null:(await t.close(),t)}async closeAll(e=!1){const t=this.openBars.reduce((r,i)=>(e===!1&&i.modal===!1||r.push(i.name),r),[]);return await Promise.all(t.map(r=>this.close(r))),this}async toggle(e,t=!1){const r=e instanceof l?e:typeof e=="string"?this.getBar(e):null;if(!r)throw new n(`Unknown bar '${e}'`);return r.isOpen()===!0?await this.close(r):await this.open(r,t)}destroy(){this.closeAll();const e=this.bars.flatMap(t=>t.name);for(const t of e)this.getBar(t)&&this.removeBar(t);return document.body.classList.remove("bartender","bartender-ready"),document.removeEventListener("keydown",this.onKeydownHandler),document.removeEventListener("bartender-bar-before-open",this.onBarBeforeOpenHandler),document.removeEventListener("bartender-bar-before-close",this.onBarBeforeCloseHandler),document.removeEventListener("bartender-bar-backdrop-click",this.onBarBackdropClickHandler),window.dispatchEvent(new u("bartender-destroyed",{detail:{bartender:this}})),this.debug&&console.debug("Bartender destroyed",this),this}}a.Bartender=m,a.BartenderBar=l,a.BartenderBarEvent=o,a.BartenderBarRemovedEvent=c,a.BartenderBarUpdatedEvent=d,a.BartenderInstanceEvent=u,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=bartender.umd.cjs.map
