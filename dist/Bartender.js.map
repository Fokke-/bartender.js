{"version":3,"file":"Bartender.js","sources":["../src/lib/utils.ts","../src/lib/BartenderError.ts","../src/lib/Overlay.ts","../src/lib/Bar.ts","../src/lib/PushElement.ts","../src/lib/Bartender.ts"],"sourcesContent":["import type { BartenderElementQuery } from './types'\n\n/**\n * Resolve HTML element\n *\n * @param {string|Element|null} query - Selector string or element\n * @param {object} parent - Parent element\n * @param {boolean} directChild - Match only to the direct child\n * @returns {HTMLElement|null} Resolved element\n */\nexport const resolveElement = (\n  query: BartenderElementQuery,\n  parent: Document | HTMLElement = document,\n  directChild = false\n): HTMLElement | null => {\n  if (!query) return null\n  if (query instanceof Element) return query as HTMLElement\n  if (typeof query === 'string') {\n    if (directChild) {\n      return parent.querySelector(`:scope > ${query}`) as HTMLElement\n    }\n\n    return parent.querySelector(query) as HTMLElement\n  }\n\n  return null\n}\n\n/**\n * Sleep for given number of milliseconds\n *\n * @param {number} duration - Duration in milliseconds\n * @returns {Promise<void>}\n */\nexport const sleep = (duration = 100): Promise<void> => {\n  return new Promise(resolve => {\n    if (!duration) return resolve()\n\n    return setTimeout(resolve, duration)\n  })\n}\n\n/**\n * Set dvh unit\n *\n * @returns {void}\n */\nexport const setDvh = (): number | null => {\n  if (typeof window === 'undefined') return null\n\n  document.documentElement.style.setProperty('--dvh', `${window.innerHeight * 0.01}px`)\n\n  return window.innerHeight * 0.01\n}\n","/**\n * Bartender error\n */\nexport class BartenderError extends Error {\n\n  /**\n   * @param {string} message - Error message\n   */\n  constructor (message: string) {\n    super(message)\n    this.name = 'Bartender error'\n  }\n\n}\n","import { BartenderError } from './BartenderError'\n\n/**\n * Bartender overlay\n */\nexport class Overlay {\n\n  /** @property {boolean} _name - Overlay object name */\n  private _name = ''\n\n  /** @property {boolean} _enabled - Enable overlay? */\n  private _enabled = true\n\n  /** @property {HTMLElement} el - Overlay element */\n  readonly el: HTMLElement\n\n  /**\n   * Create a new overlay\n   *\n   * @param {string} name - Overlay object name\n   * @param {boolean} enabled - Enable overlay?\n   */\n  constructor (name: string, enabled = true) {\n    this.el = document.createElement('div')\n    this.el.classList.add('bartender__overlay')\n\n    try {\n      this.name = name\n    } catch (error) {\n      if (error instanceof DOMException) throw new BartenderError(`Name '${name}' is not valid HTML class name`)\n\n      throw new BartenderError(error as string)\n    }\n\n    this.enabled = enabled\n  }\n\n  /**\n   * Destroy overlay instance\n   *\n   * @returns {this}\n   */\n  public destroy (): this {\n    this.el.remove()\n\n    return this\n  }\n\n  /** @type {string} */\n  public get name () {\n    return this._name\n  }\n\n  /** @type {string} */\n  public set name (name: string) {\n    this.el.classList.remove(`bartender__overlay--${this._name}`)\n    this.el.classList.add(`bartender__overlay--${name}`)\n    this._name = name\n  }\n\n  /** @type {boolean} */\n  public get enabled () {\n    return this._enabled\n  }\n\n  /** @type {boolean} */\n  public set enabled (val: boolean) {\n    if (val === true) {\n      this.el.classList.remove('bartender__overlay--transparent')\n    } else {\n      this.el.classList.add('bartender__overlay--transparent')\n    }\n\n    this._enabled = val\n  }\n\n  /**\n   * Show overlay\n   *\n   * @returns {this}\n   */\n  public show (): this {\n    this.el.classList.add('bartender__overlay--visible')\n\n    return this\n  }\n\n  /**\n   * Hide overlay\n   *\n   * @returns {this}\n   */\n  public hide (): this {\n    this.el.classList.remove('bartender__overlay--visible')\n\n    return this\n  }\n\n}\n","import type {\n  BartenderBarOptions,\n  BartenderBarPosition,\n  BartenderBarMode,\n  BartenderPushStyles\n} from './types'\nimport * as focusTrap from 'focus-trap'\nimport { BartenderError } from './BartenderError'\nimport { Overlay } from './Overlay'\nimport {\n  resolveElement,\n  sleep\n} from './utils'\n\n/**\n * Bartender bar\n */\nexport class Bar {\n  /** @property {boolean} debug - Enable debug mode? */\n  public debug = false\n\n  /** @property {boolean} initialized - Is bar initialized? */\n  private initialized = false\n\n  /** @property {Overlay} overlayObj - Overlay object for the bar */\n  readonly overlayObj: Overlay\n\n  /** @property {string} _name - Bar name */\n  private _name = ''\n\n  /** @property {HTMLElement} el - Bar element */\n  readonly el: HTMLElement\n\n  /** @property {string} _position - Bar position */\n  private _position: BartenderBarPosition = 'left'\n\n  /** @property {string} _mode - Bar mode */\n  private _mode: BartenderBarMode = 'float'\n\n  /** @property {boolean} _overlay - Enable overlay? */\n  private _overlay = true\n\n  /** @property {boolean} _permanent - Enable permanent mode? */\n  private _permanent = false\n\n  /** @property {boolean} _scrollTop - Scroll to the top when bar is opened? */\n  private _scrollTop = true\n\n  /** @property {boolean} focusTrap - Enable focus trap? */\n  private _focusTrap = false\n\n  /** @property {boolean} isOpened - Is the bar currently open? */\n  private isOpened = false\n\n  /** @property {object|null} trap - Focus trap */\n  private trap: focusTrap.FocusTrap\n\n  /**\n   * Create a new bar\n   *\n   * @param {string} name - Unique name of the bar\n   * @param {object} options - Bar options\n   * @throws {BartenderError}\n   */\n  constructor (name: string, options: BartenderBarOptions = {}) {\n    if (!name) throw new BartenderError('Bar name is required')\n\n    this.overlayObj = new Overlay(name, this.overlay)\n    this.name = name\n\n    // Get element\n    const el = resolveElement(options.el || null)\n    if (!el) throw new BartenderError(`Content element for bar '${this.name}' is required`)\n    this.el = el\n    this.el.classList.add('bartender__bar', 'bartender__bar--closed')\n    this.el.setAttribute('tabindex', '-1')\n    this.el.setAttribute('aria-hidden', 'true')\n\n    this.position = options.position ?? this._position\n    this.mode = options.mode ?? this._mode\n    this.overlay = options.overlay ?? this._overlay\n    this.permanent = options.permanent ?? this._permanent\n    this.scrollTop = options.scrollTop ?? this._scrollTop\n    this.focusTrap = options.focusTrap ?? this.focusTrap\n    this.trap = focusTrap.createFocusTrap(this.el, {\n      initialFocus: this.el,\n      fallbackFocus: () => {\n        return this.el\n      },\n      escapeDeactivates: false,\n      clickOutsideDeactivates: false,\n      allowOutsideClick: true,\n      returnFocusOnDeactivate: false,\n      preventScroll: true,\n    })\n\n    this.initialized = true\n  }\n\n  /**\n   * Destroy bar instance\n   *\n   * @returns {this}\n   */\n  destroy (): this {\n    if (this.trap) this.trap.deactivate()\n    this.overlayObj.destroy()\n    this.el.classList.remove('bartender__bar', `bartender__bar--${this.position}`)\n\n    return this\n  }\n\n  /** @type {string} */\n  get name () {\n    return this._name\n  }\n\n  /** @type {string} */\n  set name (val: string) {\n    this._name = val\n    this.overlayObj.name = val\n\n    if (this.initialized === false) return\n\n    this.el.dispatchEvent(new CustomEvent('bartender-bar-updated', {\n      bubbles: true,\n      detail: {\n        bar: this,\n        property: 'name',\n        value: val,\n      },\n    }))\n\n    if (this.debug) console.debug('Updated bar name', this)\n  }\n\n  /** @type {string} */\n  get position () {\n    return this._position\n  }\n\n  /**\n   * @type {string}\n   * @throws {BartenderError}\n   */\n  set position (val: BartenderBarPosition) {\n    // Validate position\n    if (!val) throw new BartenderError(`Position is required for bar '${this.name}'`)\n\n    const validPositions = [\n      'left',\n      'right',\n      'top',\n      'bottom',\n    ]\n\n    if (!validPositions.includes(val)) throw new BartenderError(`Invalid position '${val}' for bar '${this.name}'. Use one of the following: ${validPositions.join(', ')}.`)\n\n    // Temporarily disable transition\n    this.el.classList.add('bartender-disable-transition')\n\n    // Update element classes\n    this.el.classList.remove(`bartender__bar--${this._position}`)\n    this.el.classList.add(`bartender__bar--${val}`)\n\n    // Set new position\n    this._position = val\n\n    // Return transition\n    setTimeout(() => {\n      this.el.classList.remove('bartender-disable-transition')\n    })\n\n    if (this.initialized === false) return\n\n    // If position was changed after bar was created,\n    // dispatch event to update pushable elements\n    this.el.dispatchEvent(new CustomEvent('bartender-bar-updated', {\n      bubbles: true,\n      detail: {\n        bar: this,\n        property: 'position',\n        value: val,\n      },\n    }))\n\n    if (this.debug) console.debug('Updated bar position', this)\n  }\n\n  /** @type {string} */\n  get mode () {\n    return this._mode\n  }\n\n  /**\n   * @type {string}\n   * @throws {BartenderError}\n   */\n  set mode (val: BartenderBarMode) {\n    // Validate mode\n    if (!val) throw new BartenderError(`Mode is required for bar '${this.name}'`)\n\n    const validModes = [\n      'float',\n      'push',\n      'reveal',\n    ]\n\n    if (!validModes.includes(val)) throw new BartenderError(`Invalid mode '${val}' for bar '${this.name}'. Use one of the following: ${validModes.join(', ')}.`)\n\n    // Temporarily disable transition\n    this.el.classList.add('bartender-disable-transition')\n\n    // Update element classes\n    this.el.classList.remove(`bartender__bar--${this._mode}`)\n    this.el.classList.add(`bartender__bar--${val}`)\n\n    // Set new mode\n    this._mode = val\n\n    // Return transition\n    setTimeout(() => {\n      this.el.classList.remove('bartender-disable-transition')\n    })\n\n    if (this.initialized === false) return\n\n    // If mode was changed after bar was created,\n    // dispatch event to update pushable elements\n    this.el.dispatchEvent(new CustomEvent('bartender-bar-updated', {\n      bubbles: true,\n      detail: {\n        bar: this,\n        property: 'mode',\n        value: this._mode,\n      },\n    }))\n\n    if (this.debug) console.debug('Updated bar mode', this)\n  }\n\n  /** @type {boolean} */\n  get overlay () {\n    return this._overlay\n  }\n\n  /** @type {boolean} */\n  set overlay (val: boolean) {\n    this._overlay = val\n    this.overlayObj.enabled = val\n\n    if (this.initialized === false) return\n\n    this.el.dispatchEvent(new CustomEvent('bartender-bar-updated', {\n      bubbles: true,\n      detail: {\n        bar: this,\n        property: 'overlay',\n        value: val,\n      },\n    }))\n\n    if (this.debug) console.debug('Updated bar overlay', this, this.overlayObj)\n  }\n\n  /** @type {boolean} */\n  get permanent () {\n    return this._permanent\n  }\n\n  /** @type {boolean} */\n  set permanent (val: boolean) {\n    this._permanent = val\n\n    if (this.initialized === false) return\n\n    this.el.dispatchEvent(new CustomEvent('bartender-bar-updated', {\n      bubbles: true,\n      detail: {\n        bar: this,\n        property: 'permanent',\n        value: val,\n      },\n    }))\n\n    if (this.debug) console.debug('Updated bar permanence', this)\n  }\n\n  /** @type {boolean} */\n  get scrollTop () {\n    return this._scrollTop\n  }\n\n  /** @type {boolean} */\n  set scrollTop (val: boolean) {\n    this._scrollTop = val\n\n    if (this.initialized === false) return\n\n    this.el.dispatchEvent(new CustomEvent('bartender-bar-updated', {\n      bubbles: true,\n      detail: {\n        bar: this,\n        property: 'scrollTop',\n        value: val,\n      },\n    }))\n\n    if (this.debug) console.debug('Updated bar scrollTop', this)\n  }\n\n  /** @type {boolean} */\n  get focusTrap () {\n    return this._focusTrap\n  }\n\n  /** @type {boolean} */\n  set focusTrap (val: boolean) {\n    this._focusTrap = val\n\n    if (this.initialized === false) return\n\n    this.el.dispatchEvent(new CustomEvent('bartender-bar-updated', {\n      bubbles: true,\n      detail: {\n        bar: this,\n        property: 'focusTrap',\n        value: val,\n      },\n    }))\n\n    if (this.debug) console.debug('Updated bar focusTrap', this)\n    if (this.isOpened === false) return\n\n    if (val === true) {\n      this.trap.activate()\n      return\n    }\n\n    this.trap.deactivate()\n  }\n\n  /**\n   * Is bar currently open?\n   *\n   * @returns {boolean}\n   */\n  public isOpen (): boolean {\n    return this.isOpened\n  }\n\n  /**\n   * Get transition duration in milliseconds\n   *\n   * @returns {number}\n   */\n  public getTransitionDuration (): number {\n    if (!this.el) return 0\n\n    const duration = window.getComputedStyle(this.el).getPropertyValue('transition-duration') || '0s'\n    return parseFloat(duration) * 1000\n  }\n\n  /**\n   * Open bar\n   *\n   * @returns {Promise<this>}\n   */\n  async open (): Promise<this> {\n    if (this.debug) console.debug('Opening bar', this)\n\n    // Dispatch 'before open' event\n    this.el.dispatchEvent(new CustomEvent('bartender-bar-before-open', {\n      bubbles: true,\n      detail: { bar: this },\n    }))\n\n    if (this.scrollTop === true) this.el.scrollTo(0, 0)\n    this.el.classList.remove('bartender__bar--closed')\n    this.el.classList.add('bartender__bar--open')\n    this.el.setAttribute('aria-hidden', 'false')\n    this.el.focus()\n    this.overlayObj.show()\n    this.isOpened = true\n\n    if (this.focusTrap === true) this.trap.activate()\n\n    await sleep(this.getTransitionDuration())\n\n    // Dispatch 'after open' event\n    this.el.dispatchEvent(new CustomEvent('bartender-bar-after-open', {\n      bubbles: true,\n      detail: { bar: this },\n    }))\n\n    if (this.debug) console.debug('Finished opening bar', this)\n\n    return Promise.resolve(this)\n  }\n\n  /**\n   * Close bar\n   *\n   * @returns {Promise<this>}\n   */\n  async close (): Promise<this> {\n    if (this.debug) console.debug('Closing bar', this)\n\n    this.el.dispatchEvent(new CustomEvent('bartender-bar-before-close', {\n      bubbles: true,\n      detail: { bar: this },\n    }))\n\n    this.el.classList.remove('bartender__bar--open')\n    this.el.setAttribute('aria-hidden', 'true')\n    this.overlayObj.hide()\n    this.isOpened = false\n    if (this.trap) this.trap.deactivate()\n\n    await sleep(this.getTransitionDuration())\n\n    this.el.classList.add('bartender__bar--closed')\n    this.el.dispatchEvent(new CustomEvent('bartender-bar-after-close', {\n      bubbles: true,\n      detail: { bar: this },\n    }))\n\n    if (this.debug) console.debug('Finished closing bar', this)\n\n    return Promise.resolve(this)\n  }\n\n  /**\n   * Get styles for pushable elements\n   *\n   * @returns {object}\n   */\n  getPushStyles (): BartenderPushStyles {\n    if (!this.position || !this.el) {\n      return {\n        transform: '',\n        transitionDuration: '',\n        transitionTimingFunction: '',\n      }\n    }\n\n    return {\n      transform: {\n        left: `translateX(${this.el.offsetWidth}px)`,\n        right: `translateX(-${this.el.offsetWidth}px)`,\n        top: `translateY(${this.el.offsetHeight}px)`,\n        bottom: `translateY(-${this.el.offsetHeight}px)`,\n      }[this.position] || '',\n      transitionDuration: window.getComputedStyle(this.el).getPropertyValue('transition-duration') || '',\n      transitionTimingFunction: window.getComputedStyle(this.el).getPropertyValue('transition-timing-function') || '',\n    }\n  }\n}\n","import type {\n  BartenderElementQuery,\n  BartenderPushElementOptions,\n  BartenderBarMode,\n  BartenderPushStyles,\n  BartenderBarPosition\n} from './types'\nimport { BartenderError } from './BartenderError'\nimport { Bar } from './Bar'\nimport { resolveElement } from './utils'\n\n/**\n * Bartender pushable element\n */\nexport class PushElement {\n\n  /** @property {HTMLElement} el - Element to push */\n  readonly el: HTMLElement\n\n  /** @property {Bar[]} bars - Matched bars */\n  readonly bars: Bar[]\n\n  /** @property {string[]} modes - Matched modes */\n  readonly modes: BartenderBarMode[]\n\n  /** @property {string[]} positions - Matched positions */\n  readonly positions: BartenderBarPosition[]\n\n  /** @property {boolean} isPushed - Is the element currently pushed? */\n  private isPushed = false\n\n  /**\n   * Create a new pushable element\n   *\n   * @param {BartenderElementQuery} el - Pushable element\n   * @param {object} options - Options for pushable element\n   * @throws {BartenderError}\n   */\n  constructor (el: BartenderElementQuery, options: BartenderPushElementOptions = {}) {\n    // Get element\n    const element = resolveElement(el || null)\n    if (!element) throw new BartenderError('Element is required for push element')\n\n    this.el = element\n    this.bars = options.bars || []\n    this.modes = options.modes || []\n    this.positions = options.positions || []\n  }\n\n  /**\n   * Push element\n   *\n   * @param {Bar} bar - The bar to match against push element properties\n   * @param {object} pushStyles - Push styles from the bar\n   * @returns {this}\n   */\n  public push (bar: Bar, pushStyles: BartenderPushStyles): this {\n    // If this element is not supposed to be pushed,\n    // clear transition styles\n    if (\n      (this.bars.length && !this.bars.includes(bar)) ||\n      (this.modes.length && !this.modes.includes(bar.mode)) ||\n      (this.positions.length && !this.positions.includes(bar.position))\n    ) {\n      this.el.style.transform = ''\n      this.el.style.transitionTimingFunction = ''\n      this.el.style.transitionDuration = ''\n      this.isPushed = false\n\n      return this\n    }\n\n    this.el.style.transform = pushStyles.transform\n    this.el.style.transitionTimingFunction = pushStyles.transitionTimingFunction\n    this.el.style.transitionDuration = pushStyles.transitionDuration\n    this.isPushed = true\n\n    return this\n  }\n\n  /**\n   * Pull element and return it to the original position\n   *\n   * @param {object} pushStyles - Push styles from the bar\n   * @returns {this}\n   */\n  public pull (pushStyles: BartenderPushStyles): this {\n    if (this.isPushed === false) return this\n\n    this.el.style.transform = 'translateX(0) translateY(0)'\n    this.el.style.transitionTimingFunction = pushStyles.transitionTimingFunction\n    this.el.style.transitionDuration = pushStyles.transitionDuration\n    this.isPushed = false\n\n    return this\n  }\n\n}\n","import type {\n  BartenderOptions,\n  BartenderBarDefaultOptions,\n  BartenderBarOptions,\n  BartenderElementQuery,\n  BartenderPushElementOptions\n} from './types'\nimport { Queue } from 'async-await-queue'\nimport { debounce } from 'ts-debounce'\nimport {\n  resolveElement,\n  sleep,\n  setDvh\n} from './utils'\nimport { BartenderError } from './BartenderError'\nimport { Bar } from './Bar'\nimport { PushElement } from './PushElement'\n\n/**\n * Class for creating accessible off-canvas bars.\n */\nexport class Bartender {\n\n  /** @property {boolean} debug - Enable debug mode? */\n  private _debug = false\n\n  /** @property {HTMLElement} el - Main element */\n  readonly el: HTMLElement\n\n  /** @property {HTMLElement} contentEl - Content element */\n  readonly contentEl: HTMLElement\n\n  /** @property {number} switchTimeout - Time to wait in milliseconds until another bar is opened */\n  public switchTimeout = 150\n\n  /** @property {Bar[]} bars - Bars added to the instance */\n  readonly bars: Bar[] = []\n\n  /** @property {object} barDefaultOptions - Default options for the bars */\n  readonly barDefaultOptions: BartenderBarOptions = {\n    el: null,\n    position: 'left',\n    mode: 'float',\n    overlay: true,\n    permanent: false,\n    scrollTop: true,\n    focusTrap: false,\n  }\n\n  /** @property {HTMLElement|null} returnFocus - Reference to the element to which focus will be restored after closing the bar */\n  private returnFocus?: HTMLElement | null = null\n\n  /** @property {PushElement[]} pushableElements - Pushable elements added to the instance */\n  private pushableElements: PushElement[] = []\n\n  /** @property {object} queue - Queue for actions */\n  private queue: Queue\n\n  /** @property {Function} resizeDebounce - Debouncer for resizing */\n  private resizeDebounce\n\n  /** @property {Function} resizeDebounce - Debouncer for resizing */\n  private onBarUpdateHandler\n\n  /** @property {Function} onKeydownHandler - Handler for keydown event */\n  private onKeydownHandler\n\n  /** @property {Function} onKeydownHandler - Handler for resize event */\n  private onResizeHandler\n\n  /**\n   * Create a new Bartender instance\n   *\n   * @param {object} options - Instance options\n   * @param {object} barOptions - Default options for bars\n   * @throws {BartenderError}\n   */\n  constructor (\n    options: BartenderOptions = {},\n    barOptions: BartenderBarDefaultOptions = {}\n  ) {\n    // Polyfill DVH units\n    setDvh()\n    document.addEventListener('DOMContentLoaded', () => {\n      setDvh()\n    })\n\n    this.debug = options.debug ?? this._debug\n    this.switchTimeout = options.switchTimeout ?? this.switchTimeout\n    this.barDefaultOptions = {\n      ...this.barDefaultOptions,\n      ...barOptions,\n    }\n\n    // Main element\n    const el = resolveElement(options.el || '.bartender')\n    if (!el) throw new BartenderError('Main element is required')\n    this.el = el\n    this.el.classList.add('bartender')\n\n    // Content element\n    const contentEl = resolveElement(options.contentEl || '.bartender__content')\n    if (!contentEl) throw new BartenderError('Content element is required')\n    if (contentEl.parentElement !== this.el) throw new BartenderError('Content element must be a direct child of the main element')\n    this.contentEl = contentEl\n    this.contentEl.classList.add('bartender__content')\n    this.contentEl.setAttribute('tabindex', '-1')\n\n    // Register content element as pushable element\n    this.addPushElement(this.contentEl, {\n      modes: [\n        'push',\n        'reveal',\n      ],\n    })\n\n    // Queue for actions\n    this.queue = new Queue(1)\n\n    // Debouncer for resizing\n    this.resizeDebounce = debounce(() => {\n      setDvh()\n      this.pushElements(this.getOpenBar())\n    }, 100)\n\n    // Event listeners\n    this.onBarUpdateHandler = this.onBarUpdate.bind(this)\n    window.addEventListener('bartender-bar-updated', this.onBarUpdateHandler)\n\n    this.onKeydownHandler = this.onKeydown.bind(this)\n    window.addEventListener('keydown', this.onKeydownHandler)\n\n    this.onResizeHandler = this.onResize.bind(this)\n    window.addEventListener('resize', this.onResizeHandler)\n\n    this.el.classList.add('bartender--ready')\n    this.el.dispatchEvent(new CustomEvent('bartender-init', {\n      bubbles: true,\n      detail: { bartender: this },\n    }))\n\n    if (this.debug) console.debug('Bartender initialized', this)\n  }\n\n  /** @type {boolean} */\n  get debug () {\n    return this._debug\n  }\n\n  /** @type {boolean} */\n  set debug (val: boolean) {\n    this._debug = val\n\n    for (const bar of this.bars) {\n      bar.debug = val\n    }\n  }\n\n  /**\n   * Destroy Bartender instance\n   *\n   * @returns {Promise<this>}\n   */\n  public async destroy (): Promise<this> {\n    await this.close()\n\n    // Get all bar names\n    const barNames = this.bars.reduce((acc: string[], bar) => {\n      acc.push(bar.name)\n      return acc\n    }, [])\n\n    // Remove bars\n    for (const name of barNames) {\n      if (!this.getBar(name)) continue\n\n      await this.removeBar(name)\n    }\n\n    // Remove classes\n    this.el.classList.remove('bartender', 'bartender--ready')\n    this.contentEl.classList.remove('bartender__content')\n\n    // Remove event listeners\n    window.removeEventListener('bartender-bar-updated', this.onBarUpdateHandler)\n    window.removeEventListener('keydown', this.onKeydownHandler)\n    window.removeEventListener('resize', this.onResizeHandler)\n\n    this.el.dispatchEvent(new CustomEvent('bartender-destroyed', {\n      bubbles: true,\n      detail: { bartender: this },\n    }))\n\n    if (this.debug) console.debug('Bartender destroyed', this)\n\n    return Promise.resolve(this)\n  }\n\n  /**\n   * Get bar by name\n   *\n   * @param {string} name - Bar name\n   * @returns {object|null}\n   */\n  public getBar (name: string): Bar | null {\n    return this.bars.find(item => item.name === name) || null\n  }\n\n  /**\n   * Get currently open bar\n   *\n   * @returns {object|null}\n   */\n  private getOpenBar (): Bar | null {\n    return this.bars.find(item => item.isOpen() === true) || null\n  }\n\n  /**\n   * Add a new bar\n   *\n   * @param {string} name - Unique name for the bar\n   * @param {object} options - Bar options\n   * @throws {BartenderError}\n   * @returns {object} Bar object\n   */\n  public addBar (name: string, options: BartenderBarOptions = {}): Bar {\n    if (!name || typeof name !== 'string') throw new BartenderError('Bar name is required')\n    if (this.getBar(name)) throw new BartenderError(`Bar with name '${name}' is already defined`)\n\n    // Create a new bar\n    const bar = new Bar(name, {\n      ...this.barDefaultOptions,\n      ...options,\n    })\n\n    // Set debug mode\n    bar.debug = this.debug\n\n    // Check that element is not assigned to another bar\n    if (this.bars.some(item => item.el === bar.el)) throw new BartenderError(`Element of bar '${bar.name}' is already being used for another bar`)\n\n    // Check that bar element is a direct child on main element\n    if (bar.el.parentElement !== this.el) throw new BartenderError(`Element of bar '${bar.name}' must be a direct child of the Bartender main element`)\n\n    // Insert overlay element\n    this.el.appendChild(bar.overlayObj.el)\n    bar.overlayObj.el.addEventListener('click', () => {\n      if (bar.permanent === true) return\n\n      this.close()\n    })\n\n    // Set overlay as pushable element\n    this.addPushElement(bar.overlayObj.el, {\n      bars: [\n        bar,\n      ],\n    })\n\n    this.bars.push(bar)\n\n    this.el.dispatchEvent(new CustomEvent('bartender-bar-added', {\n      bubbles: true,\n      detail: { bar },\n    }))\n\n    if (this.debug) console.debug('Added a new bar', bar)\n\n    return bar\n  }\n\n  /**\n   * Remove bar\n   *\n   * @param {string} name - Bar name\n   * @throws {BartenderError}\n   * @returns {Promise<this>}\n   */\n  public async removeBar (name: string): Promise<this> {\n    if (!name || typeof name !== 'string') throw new BartenderError('Bar name is required')\n\n    const bar = this.getBar(name)\n    if (!bar) throw new BartenderError(`Bar with name '${name}' was not found`)\n    if (this.getOpenBar() === bar) this.close()\n\n    this.removePushElement(bar.overlayObj.el)\n    bar.destroy()\n\n    const barIndex = this.bars.findIndex(item => item.name === name)\n    this.bars.splice(barIndex, 1)\n\n    this.el.dispatchEvent(new CustomEvent('bartender-bar-removed', {\n      bubbles: true,\n      detail: { name },\n    }))\n\n    if (this.debug) console.debug(`Removed bar '${name}'`)\n\n    return Promise.resolve(this)\n  }\n\n  /**\n   * Open bar\n   *\n   * @param {string} name - Bar name\n   * @throws {BartenderError}\n   * @returns {Promise<Bar>}\n   */\n  private async openBar (name: string): Promise<Bar> {\n    const bar = this.getBar(name)\n    if (!bar) throw new BartenderError(`Unknown bar '${name}'`)\n    if (bar.isOpen() === true) return Promise.resolve(bar)\n\n    // Close any open bar\n    const openBar = this.getOpenBar()\n\n    if (openBar) {\n      await this.closeBar(openBar.name, true)\n      await sleep(this.switchTimeout)\n    }\n\n    this.el.classList.add('bartender--open')\n    this.contentEl.setAttribute('aria-hidden', 'true')\n    this.pushElements(bar)\n\n    return bar.open()\n  }\n\n  /**\n   * Open bar\n   *\n   * @param {string} name - Bar name\n   * @param {HTMLElement|null} returnFocus - Reference to the element to which focus will be restored after closing the bar\n   * @returns {Promise<Bar>}\n   */\n  public async open (name: string, returnFocus?: HTMLElement | null): Promise<Bar> {\n    const id = Symbol()\n    await this.queue.wait(id)\n\n    this.returnFocus = returnFocus\n\n    return this.openBar(name).finally(() => {\n      this.queue.end(id)\n    })\n  }\n\n  /**\n   * Close bar\n   *\n   * @param {string} name - Bar name\n   * @param {boolean} switching - Will another bar open immediately after closing?\n   * @returns {Promise<Bar|null>}\n   */\n  private async closeBar (name?: string, switching = false): Promise<Bar | null> {\n    const bar = name ? this.getBar(name) : this.getOpenBar()\n    if (!bar || !bar.isOpen()) return Promise.resolve(null)\n\n    this.pullElements(bar)\n    await bar.close()\n\n    // If we going to open another bar right after closing the current one,\n    // don't update elements yet.\n    if (switching === false) {\n      this.el.classList.remove('bartender--open')\n      this.contentEl.setAttribute('aria-hidden', 'false')\n    }\n\n    return Promise.resolve(bar)\n  }\n\n  /**\n   * Close bar\n   *\n   * @param {string} name - Bar name\n   * @returns {Promise<Bar|null>}\n   */\n  public async close (name?: string): Promise<Bar | null> {\n    const id = Symbol()\n    await this.queue.wait(id)\n\n    return this.closeBar(name).finally(() => {\n      this.queue.end(id)\n\n      // Return focus\n      if (this.returnFocus) {\n        this.returnFocus.focus()\n        this.returnFocus = null\n        return\n      }\n\n      this.contentEl.focus()\n    })\n  }\n\n  /**\n   * Toggle bar\n   *\n   * @param {string} name - Bar name\n   * @param {HTMLElement|null} returnFocus - Reference to the element to which focus will be restored after closing the bar\n   * @throws {BartenderError}\n   * @returns {Promise<Bar|null>}\n   */\n  public async toggle (name: string, returnFocus?: HTMLElement | null): Promise<Bar | null> {\n    const bar = this.getBar(name)\n    if (!bar) throw new BartenderError(`Unknown bar '${name}'`)\n\n    return (bar.isOpen() === true) ? this.close() : this.open(name, returnFocus)\n  }\n\n  /**\n   * Add a new pushable element\n   *\n   * @param {BartenderElementQuery} el - Pushable element\n   * @param {object} options - Options for pushable element\n   * @returns {PushElement}\n   */\n  public addPushElement (el: BartenderElementQuery, options: BartenderPushElementOptions = {}): PushElement {\n    if (this.pushableElements.some(item => item.el === el)) throw new BartenderError('This element is already defined as pushable element.')\n\n    const pushElement = new PushElement(el, options)\n    this.pushableElements.push(pushElement)\n\n    if (this.debug) console.debug('Added a new pushable element', pushElement)\n\n    return pushElement\n  }\n\n  /**\n   * Remove pushable element\n   *\n   * @param {Element} el - Element to remove\n   * @throws {BartenderError}\n   * @returns {PushElement[]}\n   */\n  public removePushElement (el: Element): PushElement[] {\n    const index = this.pushableElements.findIndex(item => item.el === el)\n    if (index === -1) throw new BartenderError('Pushable element was not found')\n\n    if (this.debug) console.debug('Removed pushable element', this.pushableElements[index])\n    this.pushableElements.splice(index, 1)\n\n    return this.pushableElements\n  }\n\n  /**\n   * Push elements\n   *\n   * @param {Bar|null} bar - The bar from which the styles are fetched\n   * @returns {PushElement[]}\n   */\n  private pushElements (bar: Bar | null): PushElement[] {\n    if (!bar || !this.pushableElements.length) return this.pushableElements\n\n    const pushStyles = bar.getPushStyles()\n\n    for (const item of this.pushableElements) {\n      item.push(bar, pushStyles)\n    }\n\n    return this.pushableElements\n  }\n\n  /**\n   * Pull elements and return them to the original position\n   *\n   * @param {Bar|null} bar - The bar from which the styles are fetched\n   * @returns {PushElement[]}\n   */\n  private pullElements (bar: Bar | null): PushElement[] {\n    if (!bar || !this.pushableElements.length) return this.pushableElements\n\n    const pushStyles = bar.getPushStyles()\n\n    for (const item of this.pushableElements) {\n      item.pull(pushStyles)\n    }\n\n    return this.pushableElements\n  }\n\n  /**\n   * Handler for bartender-bar-updated event\n   *\n   * @returns {void}\n   */\n  private onBarUpdate (): void {\n    this.pushElements(this.getOpenBar())\n  }\n\n  /**\n   * Handler for keydown event\n   *\n   * @param {KeyboardEvent} event\n   * @returns {void}\n   */\n  private onKeydown (event: KeyboardEvent): void {\n    if (event.key === 'Escape') {\n      const openBar = this.getOpenBar()\n      if (!openBar || openBar.permanent === true) return\n\n      this.close()\n    }\n  }\n\n  /**\n   * Handler for resize event\n   *\n   * @returns {void}\n   */\n  private onResize (): void {\n    this.resizeDebounce()\n  }\n\n}\n"],"names":["resolveElement","query","parent","directChild","sleep","duration","resolve","setDvh","BartenderError","message","Overlay","name","enabled","__publicField","error","val","Bar","options","el","_a","_b","_c","_d","_e","_f","focusTrap","validPositions","validModes","__async","PushElement","element","bar","pushStyles","Bartender","barOptions","__spreadValues","contentEl","Queue","debounce","barNames","acc","item","barIndex","openBar","returnFocus","id","switching","pushElement","index","event"],"mappings":"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"}