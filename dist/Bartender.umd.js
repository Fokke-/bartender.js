(function(o,n){typeof exports=="object"&&typeof module!="undefined"?n(exports):typeof define=="function"&&define.amd?define(["exports"],n):(o=typeof globalThis!="undefined"?globalThis:o||self,n(o.Bartender={}))})(this,function(o){"use strict";var E=Object.defineProperty;var p=Object.getOwnPropertySymbols;var w=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable;var f=(o,n,s)=>n in o?E(o,n,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[n]=s,h=(o,n)=>{for(var s in n||(n={}))w.call(n,s)&&f(o,s,n[s]);if(p)for(var s of p(n))g.call(n,s)&&f(o,s,n[s]);return o};var r=(o,n,s)=>(f(o,typeof n!="symbol"?n+"":n,s),s);var u=(o,n,s)=>new Promise((d,c)=>{var b=t=>{try{e(s.next(t))}catch(i){c(i)}},l=t=>{try{e(s.throw(t))}catch(i){c(i)}},e=t=>t.done?d(t.value):Promise.resolve(t.value).then(b,l);e((s=s.apply(o,n)).next())});const n="",s=(l,e)=>{if(l instanceof HTMLElement)return l;if(typeof e=="string")return document.querySelector(e)||void 0},d=(l=100)=>new Promise(e=>l?setTimeout(e,l):e());class c{constructor(e,t={}){r(this,"name");r(this,"el");r(this,"elSelector");r(this,"position");r(this,"mode");r(this,"isPushing",!1);r(this,"permanent",!1);r(this,"isOpen",!1);if(!e)throw"Bar name is required";if(Object.assign(this,t),this.name=e,this.el=s(this.el,this.elSelector),!this.el)throw`Content element for bar '${this.name}' is required`;this.el.style.transition="none",this.el.classList.add("bartender__bar"),this.setPosition(this.position),this.setMode(this.mode),setTimeout(()=>{this.el&&(this.el.style.transition="")})}getTransitionDuration(){if(!this.el)return 0;const e=window.getComputedStyle(this.el).getPropertyValue("transition-duration")||"0s";return parseFloat(e)*1e3}setPosition(e){var i,a;if(!e)throw`Position is required for bar '${this.name}'`;const t=["left","right","top","bottom"];if(!t.includes(e))throw`Invalid position '${e}' for bar '${this.name}'. Use one of the following: ${t.join(", ")}.`;return this.position&&((i=this.el)==null||i.classList.remove(`bartender__bar--${this.position}`)),this.position=e,(a=this.el)==null||a.classList.add(`bartender__bar--${this.position}`),this}setMode(e){var i,a;if(!e)throw`Mode is required for bar '${this.name}'`;const t=["float","push","reveal"];if(!t.includes(e))throw`Invalid mode '${e}' for bar '${this.name}'. Use one of the following: ${t.join(", ")}.`;return this.isPushing=["push","reveal"].includes(e),console.log(this.isPushing),this.mode&&((i=this.el)==null||i.classList.remove(`bartender__bar--${this.mode}`)),this.mode=e,(a=this.el)==null||a.classList.add(`bartender__bar--${this.mode}`),this}open(){return u(this,null,function*(){var e,t,i;return(e=this.el)==null||e.dispatchEvent(new CustomEvent("bartender-bar-before-open",{bubbles:!0,detail:{bar:this}})),(t=this.el)==null||t.classList.add("bartender__bar--open"),this.isOpen=!0,yield d(this.getTransitionDuration()),(i=this.el)==null||i.dispatchEvent(new CustomEvent("bartender-bar-after-open",{bubbles:!0,detail:{bar:this}})),Promise.resolve(this)})}close(){return u(this,null,function*(){var e,t,i;return(e=this.el)==null||e.dispatchEvent(new CustomEvent("bartender-bar-before-close",{bubbles:!0,detail:{bar:this}})),(t=this.el)==null||t.classList.remove("bartender__bar--open"),this.isOpen=!1,yield d(this.getTransitionDuration()),(i=this.el)==null||i.dispatchEvent(new CustomEvent("bartender-bar-after-close",{bubbles:!0,detail:{bar:this}})),Promise.resolve(this)})}getPushStyles(){return!this.position||!this.el?null:{transform:(()=>{var e,t,i,a;switch(this.position){case"left":return`translateX(${(e=this.el)==null?void 0:e.offsetWidth}px)`;case"right":return`translateX(-${(t=this.el)==null?void 0:t.offsetWidth}px)`;case"top":return`translateY(${(i=this.el)==null?void 0:i.offsetHeight}px)`;case"bottom":return`translateY(-${(a=this.el)==null?void 0:a.offsetHeight}px)`;default:return""}})(),transitionDuration:window.getComputedStyle(this.el).getPropertyValue("transition-duration")||"",transitionTimingFunction:window.getComputedStyle(this.el).getPropertyValue("transition-timing-function")||""}}}class b{constructor(e={},t={}){r(this,"debug",!1);r(this,"busy",!1);r(this,"mainEl");r(this,"mainElSelector");r(this,"contentEl");r(this,"contentElSelector");r(this,"switchTimeout");r(this,"bars",[]);r(this,"pushableElements",[]);r(this,"barOptions",{});Object.assign(this,h(h({},{debug:!1,mainEl:void 0,mainElSelector:".bartender",contentEl:void 0,contentElSelector:".bartender__content",switchTimeout:100}),e));const a={position:"left",mode:"float",permanent:!1};if(this.barOptions=h(h({},a),t),this.mainEl=s(this.mainEl,this.mainElSelector),!this.mainEl)throw"Main element is required";if(this.contentEl=s(this.contentEl,this.contentElSelector),!this.contentEl)throw"Content element is required";if(this.addPushElement({el:this.contentEl}),this.contentEl.parentElement!==this.mainEl)throw"Content element must be a direct child of the main element";window.addEventListener("keydown",this.handleKeydown.bind(this)),this.mainEl.classList.add("bartender--ready"),this.mainEl.dispatchEvent(new CustomEvent("bartender-init",{bubbles:!0,detail:{bartender:this}}))}destroy(){var e;(e=this.mainEl)==null||e.classList.remove("bartender--ready")}getBar(e){return this.bars.find(t=>t.name===e)||null}getOpenBar(){return this.bars.find(e=>e.isOpen===!0)||null}addBar(e,t={}){var m;if(!e||typeof e!="string")return Promise.reject(new Error("Name is required"));if(this.getBar(e))return Promise.reject(new Error(`Bar with name '${e}' is already defined`));const i=h(h({},this.barOptions),t),a=new c(e,i);return this.bars.push(a),(m=this.mainEl)==null||m.dispatchEvent(new CustomEvent("bartender-bar-added",{bubbles:!0,detail:{bar:a}})),Promise.resolve(a)}open(e){return u(this,null,function*(){var a;const t=this.getBar(e);return t?t.isOpen===!0?Promise.reject(new Error(`Bar '${t.name}' is already open`)):this.busy===!0?Promise.reject(new Error("Bartender is busy")):(this.busy=!0,this.getOpenBar()&&(yield this.close(),yield d(this.switchTimeout)),(a=this.mainEl)==null||a.classList.add("bartender--open"),t.isPushing===!0&&this.pushElements(t.getPushStyles()),yield t.open(),this.busy=!1,Promise.resolve(t)):Promise.reject(new Error(`Unknown bar '${e}'`))})}close(){return u(this,null,function*(){var t;const e=this.getOpenBar();return e?(this.pullElements(),yield e.close(),(t=this.mainEl)==null||t.classList.remove("bartender--open"),Promise.resolve(e)):Promise.resolve(null)})}toggle(e){return u(this,null,function*(){const t=this.getBar(e);return t?t.isOpen===!0?this.close():this.open(e):Promise.reject(new Error(`Unknown bar '${e}'`))})}addPushElement(e={}){const t=s(e.el,e.elSelector);return t?(this.pushableElements.push(t),Promise.resolve(t)):Promise.reject(new Error("Unknown push element"))}pushElements(e){if(!e||!this.pushableElements.length)return null;for(const t of this.pushableElements)t.style.transform=e.transform,t.style.transitionDuration=e.transitionDuration,t.style.transitionTimingFunction=e.transitionTimingFunction;return this.pushableElements}pullElements(){if(!this.pushableElements.length)return null;for(const e of this.pushableElements)e.style.transform="translateX(0) translateY(0)";return this.pushableElements}handleKeydown(e){e.key==="Escape"&&this.close()}}o.Bartender=b,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})});
