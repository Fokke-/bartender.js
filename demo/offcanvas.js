"use strict";function _extends(){return(_extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _createClass(t,e,n){return e&&_defineProperties(t.prototype,e),n&&_defineProperties(t,n),t}var OffCanvas=function(){function t(e){_classCallCheck(this,t),this.polyfillCustomEvent(),this.options=_extends({debug:!1,overlay:!0,closeOnEsc:!0,mainWrapSelector:".offcanvas-main",contentWrapSelector:".offcanvas-content",readyClass:"offcanvas-ready",openClass:"offcanvas-open"},e),this.overlay=null,this.currentOpenBar=null,this.previousOpenButton=null,this.resizeTimeout=null,this.bars={},this.openButtons=[],this.closeButtons=[],this.toggleButtons=[],this.pushElements=[],this.init()}return _createClass(t,[{key:"polyfillCustomEvent",value:function(){if("function"==typeof window.CustomEvent)return!1;window.CustomEvent=function(t,e){e=e||{bubbles:!1,cancelable:!1,detail:null};var n=document.createEvent("CustomEvent");return n.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),n}}},{key:"log",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";console.log("Off-canvas: "+t)}},{key:"logError",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";console.error("Off-canvas: "+t)}},{key:"debug",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.options.debug&&console.log("Off-canvas debug: "+t)}},{key:"init",value:function(){var t,e,n=this;try{if(this.mainWrap=document.querySelector(this.options.mainWrapSelector),!this.mainWrap)throw"Main wrap element was not found with selector: "+this.options.mainWrapSelector;if(this.contentWrap=this.mainWrap.querySelector(this.options.contentWrapSelector),!this.contentWrap)throw"Content wrap element was not found with selector: "+this.options.contentWrapSelector;this.openButtons=this.mainWrap.querySelectorAll("[data-offcanvas-open]"),this.closeButtons=this.mainWrap.querySelectorAll("[data-offcanvas-close]"),this.toggleButtons=this.mainWrap.querySelectorAll("[data-offcanvas-toggle]"),this.mainWrap.classList.add("offcanvas-main"),this.contentWrap.classList.add("offcanvas-content");for(var i=this.mainWrap.querySelectorAll("[data-offcanvas-bar]"),s=0;s<i.length;s++)e=i[s],n.addBar(e);if(!Object.keys(this.bars).length)throw"Cannot find any bars.";for(var o=this.openButtons,a=function(t){var e=t.getAttribute("data-offcanvas-open");n.isValidPosition(e)?(t.setAttribute("aria-expanded","false"),t.addEventListener("click",(function(i){i.preventDefault(),n.open(e,t)})),t.addEventListener("keydown",(function(i){[13,32].indexOf(i.keyCode)>=0&&(i.preventDefault(),n.open(e,t))}))):n.logError("Open button has invalid bar position '"+e+"' defined. Use one of the following values: left, right, top, bottom")},r=0;r<o.length;r++)a(o[r]);for(var l=this.toggleButtons,h=function(t){var e=t.getAttribute("data-offcanvas-toggle");n.isValidPosition(e)?(t.setAttribute("aria-expanded","false"),t.addEventListener("click",(function(i){i.preventDefault(),n.toggle(e,t)})),t.addEventListener("keydown",(function(i){[13,32].indexOf(i.keyCode)>=0&&(i.preventDefault(),n.toggle(e,t))}))):n.logError("Toggle button has invalid bar position '"+e+"' defined. Use one of the following values: left, right, top, bottom")},u=0;u<l.length;u++)h(l[u]);for(var c=this.closeButtons,f=0;f<c.length;f++)(t=c[f]).addEventListener("click",(function(t){t.preventDefault(),n.close()})),t.addEventListener("keydown",(function(t){[13,32].indexOf(t.keyCode)>=0&&(t.preventDefault(),n.close())}));this.pushElements=this.mainWrap.querySelectorAll("[data-offcanvas-push]"),this.pushElements.length&&this.debug("Registered "+this.pushElements.length+" pushable elements."),this.options.overlay&&!this.overlay&&(this.overlay=document.createElement("div"),this.overlay.classList.add("offcanvas-overlay"),this.overlay.addEventListener("click",(function(){return n.close()})),this.overlay.addEventListener("keydown",(function(t){[13,32].indexOf(t.keyCode)>=0&&(t.preventDefault(),n.close())})),this.contentWrap.appendChild(this.overlay)),this.options.closeOnEsc&&window.addEventListener("keydown",(function(t){27===t.keyCode&&(t.preventDefault(),n.close())})),window.addEventListener("resize",(function(){clearTimeout(n.resizeTimeout),n.resizeTimeout=setTimeout((function(){n.setPush()}),200)})),this.mainWrap.classList.add(this.options.readyClass)}catch(t){this.logError(t)}return this}},{key:"isValidPosition",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return["left","right","top","bottom"].indexOf(t)>=0}},{key:"addBar",value:function(t){try{var e=t.getAttribute("data-offcanvas-bar");if(!this.mainWrap||!this.contentWrap)return this;if(!this.isValidPosition(e))throw"Invalid bar position '"+e+"'. Use one of the following values: left, right, top, bottom";if(this.bars[e])throw"Duplicate bar with position '"+e+"'";var n=new OffCanvasBar;n.element=t,n.init(),this.bars[e]=n,this.debug("Added bar '"+e+"' with mode '"+n.mode+"'")}catch(t){this.logError(t)}return this}},{key:"open",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{if(!this.isValidPosition(t))throw"Invalid bar position '"+t+"'. Use one of the following values: left, right, top, bottom";var n=this.bars[t];if(!n)throw"Bar with position '"+t+"' is not defined. Use one of the following: "+Object.keys(this.bars).join(", ")+".";if(n.element.classList.contains("offcanvas-bar--open"))return;this.close(),this.debug("Opening bar '"+t+"'"),n.enableFocus(),n.element.classList.add("offcanvas-bar--open"),this.currentOpenBar=n,this.setPush(),this.mainWrap.classList.add(this.options.openClass),this.previousOpenButton=e,e&&e.setAttribute("aria-expanded",!0),this.showOverlay(),this.mainWrap.dispatchEvent(new CustomEvent("open",{detail:{bar:n,button:e}}))}catch(t){this.logError(t)}return this}},{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{if(!this.isValidPosition(t))throw"Invalid bar position '"+t+"'. Use one of the following values: left, right, top, bottom";this.currentOpenBar&&this.currentOpenBar.position==t?this.close():(this.close(),this.open(t,e))}catch(t){this.logError(t)}return this}},{key:"close",value:function(){try{if(!this.currentOpenBar)return;this.debug("Closing bar '"+this.currentOpenBar.position+"'"),this.currentOpenBar.disableFocus(),this.currentOpenBar.element.classList.remove("offcanvas-bar--open"),this.previousOpenButton&&(this.previousOpenButton.focus(),this.previousOpenButton.setAttribute("aria-expanded","false"),this.previousOpenButton=null),this.contentWrap.style.removeProperty("transform"),this.mainWrap.style.removeProperty("overflow");for(var t=this.pushElements,e=0;e<t.length;e++)t[e].style.removeProperty("transform");this.mainWrap.classList.remove(this.options.openClass),this.hideOverlay(),this.mainWrap.dispatchEvent(new CustomEvent("close",{detail:{bar:this.currentOpenBar}})),this.currentOpenBar=null}catch(t){this.logError(t)}return this}},{key:"setPush",value:function(){if(this.currentOpenBar&&this.currentOpenBar.mode){var t=null;switch(this.mainWrap.style.overflow="hidden",this.currentOpenBar.position){case"left":t="translateX("+this.currentOpenBar.element.offsetWidth+"px)";break;case"right":t="translateX(-"+this.currentOpenBar.element.offsetWidth+"px)";break;case"top":t="translateY("+this.currentOpenBar.element.offsetHeight+"px)";break;case"bottom":t="translateY(-"+this.currentOpenBar.element.offsetHeight+"px)"}["push","slide"].indexOf(this.currentOpenBar.mode)>=0&&(this.contentWrap.style.transform=t);for(var e=this.pushElements,n=0;n<e.length;n++)e[n].style.transform=t}}},{key:"showOverlay",value:function(){this.overlay&&(this.overlay.classList.contains("offcanvas-overlay--visible")||(this.debug("Showing overlay"),this.overlay.classList.add("offcanvas-overlay--visible")))}},{key:"hideOverlay",value:function(){this.overlay&&this.overlay.classList.contains("offcanvas-overlay--visible")&&(this.debug("Hiding overlay"),this.overlay.classList.remove("offcanvas-overlay--visible"))}}]),t}(),OffCanvasBar=function(){function t(){_classCallCheck(this,t),this.element=null,this.position=null,this.mode="float",this.focusableElementSelector='button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'}return _createClass(t,[{key:"init",value:function(){if(!this.element)throw"Bar element for '"+this.position+"' was not found!";if(this.position=this.element.getAttribute("data-offcanvas-bar"),!this.position)throw"Missing position for bar";if(this.element.getAttribute("data-offcanvas-bar-mode")&&(this.mode=this.element.getAttribute("data-offcanvas-bar-mode")),["float","push","slide"].indexOf(this.mode)<0)throw"Invalid mode '"+this.mode+"' for bar '"+this.position+"'. Use one of the following values: float, push, slide.";return this.disableFocus(),this}},{key:"disableFocus",value:function(){for(var t=this.element.querySelectorAll(this.focusableElementSelector),e=0;e<t.length;e++)t[e].setAttribute("tabindex","-1");return this.element.setAttribute("tabindex","-1"),this.element.setAttribute("aria-hidden","true"),this}},{key:"enableFocus",value:function(){for(var t=this.element.querySelectorAll(this.focusableElementSelector),e=0;e<t.length;e++)t[e].removeAttribute("tabindex");return this.element.removeAttribute("aria-hidden"),this.element.setAttribute("tabindex","0"),this.element.focus(),this}}]),t}();
//# sourceMappingURL=offcanvas.js.map
